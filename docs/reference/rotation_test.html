<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="description" content="Carry out a rotation test (as applied in Miller et al. 2004 and detailed in DeRuiter and Solow 2008). This test is a
variation on standard randomization or permutation tests that is appropriate for time-series of non-independent events
(for example, time series of behavioral events that tend to occur in clusters)."><title>Carry out a rotation randomization test. — rotation_test • tagtools</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.2.2/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.2.2/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Carry out a rotation randomization test. — rotation_test"><meta property="og:description" content="Carry out a rotation test (as applied in Miller et al. 2004 and detailed in DeRuiter and Solow 2008). This test is a
variation on standard randomization or permutation tests that is appropriate for time-series of non-independent events
(for example, time series of behavioral events that tend to occur in clusters)."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">tagtools</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.0.0.9000</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/Detectors.html">Detectors</a>
    <a class="dropdown-item" href="../articles/TagTools.html">Tagtools vignettes: overview and introduction</a>
    <a class="dropdown-item" href="../articles/acceleration-filtering.html">Complementary filtering for acceleration: low- &amp; high-frequency</a>
    <a class="dropdown-item" href="../articles/data-quality-error-correction.html">Data quality &amp; error correction</a>
    <a class="dropdown-item" href="../articles/detectors-draft.html">detectors draft</a>
    <a class="dropdown-item" href="../articles/dive-stats.html">Using dive_stats</a>
    <a class="dropdown-item" href="../articles/find-dives.html">Using find_dives</a>
    <a class="dropdown-item" href="../articles/fine-scale-tracking.html">Fine-scale tracking</a>
    <a class="dropdown-item" href="../articles/install-load-tagtools.html">Installing and loading tagtools</a>
    <a class="dropdown-item" href="../articles/jerk-transients.html">Jerk: a way to emphasize rapid changes in acceleration</a>
    <a class="dropdown-item" href="../articles/load-tag-data.html">Load tag data</a>
    <a class="dropdown-item" href="../articles/magnetometer-filtering.html">More complementary filtering: magnetometer &amp; dynamic acceleration</a>
    <a class="dropdown-item" href="../articles/mahalanobis-distance.html">Mahalanobis distance</a>
    <a class="dropdown-item" href="../articles/plots-and-cropping.html">Plots and cropping</a>
    <a class="dropdown-item" href="../articles/rotation-test.html">Rotation test</a>
    <a class="dropdown-item" href="../articles/tag-to-whale-frame.html">Tag orientation: From tag frame to sperm whale frame</a>
    <a class="dropdown-item" href="../articles/vectors-vs-structures.html">Vectors and scalars versus structures</a>
  </div>
</li>
      </ul><form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off"></form>

      <ul class="navbar-nav"></ul></div>

    
  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>Carry out a rotation randomization test.</h1>
      
      <div class="d-none name"><code>rotation_test.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Carry out a rotation test (as applied in Miller et al. 2004 and detailed in DeRuiter and Solow 2008). This test is a
variation on standard randomization or permutation tests that is appropriate for time-series of non-independent events
(for example, time series of behavioral events that tend to occur in clusters).</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">rotation_test</span><span class="op">(</span></span>
<span>  <span class="va">event_times</span>,</span>
<span>  <span class="va">exp_period</span>,</span>
<span>  full_period <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/range.html" class="external-link">range</a></span><span class="op">(</span><span class="va">event_times</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>,</span>
<span>  n_rot <span class="op">=</span> <span class="fl">10000</span>,</span>
<span>  ts_fun <span class="op">=</span> <span class="va">length</span>,</span>
<span>  skip_sort <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  conf_level <span class="op">=</span> <span class="fl">0.95</span>,</span>
<span>  return_rot_stats <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  <span class="va">...</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>
    <dl><dt>event_times</dt>
<dd><p>A vector of the times of events. Times can be given in any format. If <code>event_times</code> should not be sorted prior to analysis (for example, if times are given in hours of the day and the times in the dataset span several days), be sure to specify <code>skip_sort=TRUE</code>.</p></dd>


<dt>exp_period</dt>
<dd><p>A two-column vector, matrix, or data frame specifying the start and end times of the "experimental" period for the test. If a matrix or data frame is provided, one column should be start time(s) and the other end time(s). 
Note that all data that falls into any experimental period will be concatenated and passed to <code>ts_fun</code>. If finer control is desired, consider writing your own test using the underlying function <code>rotate_data</code>.</p></dd>


<dt>full_period</dt>
<dd><p>A length two vector giving the start and end times of the full period during which events in event_times might have occurred. If missing, default is range(<code>event_times</code>).</p></dd>


<dt>n_rot</dt>
<dd><p>Number of rotations (randomizations) to carry out. Default is <code>n_rot=10000</code>.</p></dd>


<dt>ts_fun</dt>
<dd><p>A function to compute the test statistic. Input provided to this function will be the times of events that occur during the "experimental" period.  The default function is <code>length</code> - in other words, the default test statistis is the number of events that happen during the experimental period.</p></dd>


<dt>skip_sort</dt>
<dd><p>Logical. Should times be sorted in ascending order? Default is <code>skip_sort=FALSE</code>.</p></dd>


<dt>conf_level</dt>
<dd><p>Confidence level to be used for the bootstrap CI calculation, specified as a proportion. (default is <code>conf_level=0.95</code>, or 95% confidence.)</p></dd>


<dt>return_rot_stats</dt>
<dd><p>Logical. Should output include the test statistics computed for each rotation of the data? Default is <code>return_rot_stats=FALSE</code>.</p></dd>


<dt>...</dt>
<dd><p>Additional inputs to be passed to <code>ts_fun</code></p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    

<p>A list containing the following components:</p><ul><li><p><strong>result</strong>, A one-row data frame with rows:
  </p><ul><li><p><strong>statistic: </strong>Test statistic (from original data)</p></li>
<li><p><strong>p_value: </strong>P-value of the test (2-sided)</p></li>
<li><p><strong>n_rot: </strong>Number of rotations</p></li>
<li><p><strong>CI_low: </strong>Lower bound on rotation-resampling percentile-based confidence interval</p></li>
<li><p><strong>CI_up: </strong>Upper bound on rotation-resampling percentile-based confidence interval</p></li>
<li><p><strong>conf_level: </strong>Confidence level, as a proportion</p></li>
</ul></li>
<li><p><strong>rot_stats</strong> (If <code>return_rot_stats</code> is TRUE), a vector of <code>n_rot</code> statistics from the rotated datasets</p></li>
</ul></div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>This implementation of the rotation test compares a test statistic (some summary of
an "experimental" time-period) to its expected value during non-experimental periods. Instead of resampling random subsets of observations from the original dataset,
the rotation test samples many contiguous blocks from the original data, each the same duration as the experimental period. The summary statistic,
computed for these "rotated" samples, provides a distribution to which the test statistic from the data can be compared.</p>
    </div>
    <div class="section level2">
    <h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a></h2>
    <p>Miller, P. J. O., Shapiro, A. D., Tyack, P. L. and Solow, A. R. (2004). Call-type matching in vocal exchanges of free-ranging resident killer whales, Orcinus orca. Anim. Behav. 67, 1099–1107.</p>
<p>DeRuiter, S. L. and Solow, A. R. (2008). A rotation test for behavioural point-process data. Anim. Behav. 76, 1103–1452.</p>
    </div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p>Advanced users seeking more flexibility may want to use the underlying function <code><a href="rotate_data.html">rotate_data</a></code> to carry out customized rotation resampling. <code><a href="rotate_data.html">rotate_data</a></code> generates one rotated dataset from <code>event_times</code> and <code>exp_period</code>.</p></div>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="va">r</span> <span class="op">&lt;-</span> <span class="fu">rotation_test</span><span class="op">(</span></span></span>
<span class="r-in"><span>  event_times <span class="op">=</span></span></span>
<span class="r-in"><span>    <span class="fl">2000</span> <span class="op">*</span> <span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html" class="external-link">runif</a></span><span class="op">(</span><span class="fl">500</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  exp_period <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">100</span>, <span class="fl">200</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  return_rot_stats <span class="op">=</span> <span class="cn">TRUE</span>, ts_fun <span class="op">=</span> <span class="va">mean</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p></p><p>Developed by Stacy DeRuiter, Mark Johnson, David Sweeney, Ye Joo McNamara-Oh, Samuel Fynewever, (Oghenkevwe) Racheal Tejevbo, Tiago Marques.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

    </footer></div>

  

  

  </body></html>

