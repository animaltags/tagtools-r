<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="tagtools">
<title>Mahalanobis distance • tagtools</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.2.2/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.2.2/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Mahalanobis distance">
<meta property="og:description" content="tagtools">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">tagtools</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="Released version">0.1.0</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="active nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/acceleration-filtering.html">Complementary filtering for acceleration: low- &amp; high-frequency</a>
    <a class="dropdown-item" href="../articles/data-quality-error-correction.html">Data quality &amp; error correction</a>
    <a class="dropdown-item" href="../articles/Detectors.html">Detectors</a>
    <a class="dropdown-item" href="../articles/dive-stats.html">Using dive_stats</a>
    <a class="dropdown-item" href="../articles/find-dives.html">Using find_dives</a>
    <a class="dropdown-item" href="../articles/fine-scale-tracking.html">Fine-scale tracking</a>
    <a class="dropdown-item" href="../articles/install-load-tagtools.html">Installing and loading tagtools</a>
    <a class="dropdown-item" href="../articles/jerk-transients.html">Jerk: a way to emphasize rapid changes in acceleration</a>
    <a class="dropdown-item" href="../articles/load-tag-data.html">Load tag data</a>
    <a class="dropdown-item" href="../articles/magnetometer-filtering.html">More complementary filtering: magnetometer &amp; dynamic acceleration</a>
    <a class="dropdown-item" href="../articles/mahalanobis-distance.html">Mahalanobis distance</a>
    <a class="dropdown-item" href="../articles/plots-and-cropping.html">Plots and cropping</a>
    <a class="dropdown-item" href="../articles/rotation-test.html">Rotation test</a>
    <a class="dropdown-item" href="../articles/tag-to-whale-frame.html">Tag orientation: From tag frame to sperm whale frame</a>
    <a class="dropdown-item" href="../articles/TagTools.html">Tagtools vignettes: overview and introduction</a>
    <a class="dropdown-item" href="../articles/vectors-vs-structures.html">Vectors and scalars versus structures</a>
  </div>
</li>
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">Changelog</a>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav">
<li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/animaltags/tagtools_r/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>

    
  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>Mahalanobis distance</h1>
                        <h4 data-toc-skip class="author">tagtools
project team</h4>
            
            <h4 data-toc-skip class="date">2023-07-11</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/animaltags/tagtools_r/blob/HEAD/vignettes/articles/mahalanobis-distance.Rmd" class="external-link"><code>vignettes/articles/mahalanobis-distance.Rmd</code></a></small>
      <div class="d-none name"><code>mahalanobis-distance.Rmd</code></div>
    </div>

    
    
<p>Welcome to the Mahalanobis distance vignette! Thanks for taking some
time to get to know our package. We hope it empowers you to make the
world a better place for marine mammals.</p>
<p>In this vignette you will learn to use the function
<code>m_dist</code>, which stands for Mahalanobis distance. You will use
<code>m_dist</code> to consider the effect of military sonar on a
Cuvier’s beaked whale.</p>
<p><em>Estimated time for this vignette: 25 minutes.</em></p>
<p>These practicals all assume that you have R/Rstudio, some basic
experience working with them, and can execute provided code, making some
user-specific changes along the way (e.g. to help R find a file you
downloaded). We will provide you with quite a few lines. To boost your
own learning, you would do well to try and write them before opening
what we give, using this just to check your work.</p>
<p>Additionally, be careful when copy-pasting special characters such as
_underscores_ and ‘quotes’. If you get an error, one thing to check is
that you have just a single, simple underscore, and
<code>'straight quotes'</code>, whether <code>'single'</code> or
<code>"double"</code> (rather than “smart quotes”).</p>
<div class="section level2">
<h2 id="what-is-mahalanobis-distance">What is Mahalanobis distance?<a class="anchor" aria-label="anchor" href="#what-is-mahalanobis-distance"></a>
</h2>
<p>Put concisely, Mahalanobis distance is a way of comparing how
different some data is to what we would expect it to be like. By
plotting more than one variable and seeing what the distribution is like
graphically, we can determine more accurately how out-of-the-ordinary
something is by computing the distance from that point to the centroid
of the points. The picture below is taken from Schwarz et al. 2012, J.
Neuroscience Methods 206(2): 120-131 and appears in the “Statistics
for”Tag Data” lecture on the animaltags website.</p>
<p><img src="mahalanobis-dist-illus.png" width="242"></p>
<p>See <a href="https://blogs.sas.com/content/iml/2012/02/15/what-is-mahalanobis-distance.html" class="external-link">this
blog post</a> for another explanation of Mahalanobis distance. You can
also consult slides on this topic in the “Statistics for Tag Data”
lecture on the animaltags website, <a href="http://animaltags.org/" class="external-link uri">http://animaltags.org/</a> or <a href="https://animaltags.netlify.app" class="external-link uri">https://animaltags.netlify.app</a> .</p>
</div>
<div class="section level2">
<h2 id="load-inspect-data">Load &amp; inspect data<a class="anchor" aria-label="anchor" href="#load-inspect-data"></a>
</h2>
<p>Consider again the dataset zc11_267a. If you want to run this
example, download the “zc11_267a.nc” file from <a href="https://github.com/animaltags/tagtools_data" class="external-link uri">https://github.com/animaltags/tagtools_data</a> and change
the file path to match where you’ve saved the files</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va">tagtools</span><span class="op">)</span></span>
<span><span class="va">ZC_file_path</span> <span class="op">&lt;-</span> <span class="st">"nc_files/zc11_267a.nc"</span></span>
<span><span class="va">zc</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/load_nc.html">load_nc</a></span><span class="op">(</span><span class="va">ZC_file_path</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/str.html" class="external-link">str</a></span><span class="op">(</span><span class="va">zc</span>, max.level <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/plott.html">plott</a></span><span class="op">(</span>X <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>Depth <span class="op">=</span> <span class="va">zc</span><span class="op">$</span><span class="va">P</span><span class="op">$</span><span class="va">data</span>, Accel <span class="op">=</span> <span class="va">zc</span><span class="op">$</span><span class="va">A</span><span class="op">$</span><span class="va">data</span><span class="op">)</span>, fsx <span class="op">=</span> <span class="va">zc</span><span class="op">$</span><span class="va">P</span><span class="op">$</span><span class="va">sampling_rate</span>, interactive <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<button class="btn btn-primary" data-toggle="collapse" data-target="#load_inspect_zc">
Show/Hide Results
</button>
<div id="load_inspect_zc" class="collapse">
<pre><code><span><span class="co">#&gt; List of 4</span></span>
<span><span class="co">#&gt;  $ A   :List of 18</span></span>
<span><span class="co">#&gt;  $ P   :List of 18</span></span>
<span><span class="co">#&gt;  $ head:List of 10</span></span>
<span><span class="co">#&gt;  $ info:List of 19</span></span>
<span><span class="co">#&gt;  - attr(*, "class")= chr [1:2] "animaltag" "list"</span></span></code></pre>
<p><img src="mahalanobis-distance_files/figure-html/unnamed-chunk-3-1.png" width="700"></p>
</div>
<ol style="list-style-type: decimal">
<li><p>How might you use Mahalanobis distance to summarise the
multivariate tag data into a single data stream? What input variables
might you choose to try to quantify how the whale might have changed its
behavior in response to sonar sounds? (If you need more context, you can
check out the paper at <a href="https://royalsocietypublishing.org/doi/10.1098/rsbl.2013.0223" class="external-link uri">https://royalsocietypublishing.org/doi/10.1098/rsbl.2013.0223</a>.)</p></li>
<li><p>Use the tag tool function m_dist to compute the Mahalanobis
distance using your chosen inputs, using the model below as a guide
(note that these choices of inputs are kind of ridiculous—do better!).
You will have to choose an averaging window length and a between-window
overlap. You can use the experiment start and end times provided. How
would you justify these choices?</p></li>
</ol>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">MDdata</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>jerk <span class="op">=</span> <span class="fu"><a href="../reference/njerk.html">njerk</a></span><span class="op">(</span><span class="va">zc</span><span class="op">$</span><span class="va">A</span>, sampling_rate <span class="op">=</span> <span class="va">zc</span><span class="op">$</span><span class="va">A</span><span class="op">$</span><span class="va">sampling_rate</span><span class="op">)</span><span class="op">$</span><span class="va">data</span>, Mx <span class="op">=</span> <span class="va">zc</span><span class="op">$</span><span class="va">P</span><span class="op">$</span><span class="va">data</span><span class="op">)</span></span>
<span><span class="va">est</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">as.numeric</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/as.POSIXlt.html" class="external-link">as.POSIXct</a></span><span class="op">(</span><span class="st">'2011-09-24 14:45:00'</span><span class="op">)</span> <span class="op">-</span> <span class="fu"><a href="https://rdrr.io/r/base/as.POSIXlt.html" class="external-link">as.POSIXct</a></span><span class="op">(</span><span class="va">zc</span><span class="op">$</span><span class="va">info</span><span class="op">$</span><span class="va">dephist_device_datetime_start</span><span class="op">)</span><span class="op">)</span><span class="op">*</span><span class="fl">3600</span></span>
<span><span class="va">eet</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">as.numeric</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/as.POSIXlt.html" class="external-link">as.POSIXct</a></span><span class="op">(</span><span class="st">'2011-09-24 15:15:00'</span><span class="op">)</span> <span class="op">-</span> <span class="fu"><a href="https://rdrr.io/r/base/as.POSIXlt.html" class="external-link">as.POSIXct</a></span><span class="op">(</span><span class="va">zc</span><span class="op">$</span><span class="va">info</span><span class="op">$</span><span class="va">dephist_device_datetime_start</span><span class="op">)</span><span class="op">)</span><span class="op">*</span><span class="fl">3600</span></span>
<span><span class="va">MD</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/m_dist.html">m_dist</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">MDdata</span>, sampling_rate<span class="op">=</span><span class="va">zc</span><span class="op">$</span><span class="va">P</span><span class="op">$</span><span class="va">sampling_rate</span>, smoothDur <span class="op">=</span> <span class="fl">10</span>, overlap <span class="op">=</span> <span class="fl">9.5</span>, expStart <span class="op">=</span> <span class="va">est</span>, expEnd <span class="op">=</span> <span class="va">eet</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">MD</span><span class="op">$</span><span class="va">t</span>, <span class="va">MD</span><span class="op">$</span><span class="va">dist</span>, type <span class="op">=</span> <span class="st">'l'</span><span class="op">)</span></span></code></pre></div>
<button class="btn btn-primary" data-toggle="collapse" data-target="#MD_and_plot">
Show/Hide Results
</button>
<div id="MD_and_plot" class="collapse">
<p><img src="mahalanobis-distance_files/figure-html/unnamed-chunk-5-1.png" width="700"></p>
</div>
<ol start="3" style="list-style-type: decimal">
<li><p>If you included dive depth as an input variable, how did it
affect the resulting distance metric? Why do you think that is? Could
there be another, better way to include information about dive profile
in the Mahalanobis distance metric?</p></li>
<li><p>Do you think there was a “change” in behavior in response to the
sonar exposure?</p></li>
<li><p>If you wanted to set a threshold for detecting a “change”, how
would you do it?</p></li>
</ol>
</div>
<div class="section level2">
<h2 id="review">Review<a class="anchor" aria-label="anchor" href="#review"></a>
</h2>
<p>You’ve learned to use <code>m_dist</code> to calculate Mahalanobis
distance with some real-world data. Well done!</p>
<p><em>If you’d like to continue working through these vignettes,
consider <code>rotation-test</code> or
<code>fine-scale-tracking</code>.</em></p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/vignette.html" class="external-link">vignette</a></span><span class="op">(</span><span class="st">'rotation-test'</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/vignette.html" class="external-link">vignette</a></span><span class="op">(</span><span class="st">'fine-scale-tracking'</span><span class="op">)</span></span></code></pre></div>
<hr>
<p>Animaltags home pages: <a href="http://animaltags.org/" class="external-link uri">http://animaltags.org/</a> (old), <a href="https://animaltags.netlify.app/" class="external-link uri">https://animaltags.netlify.app/</a> (new), <a href="https://github.com/stacyderuiter/TagTools" class="external-link uri">https://github.com/stacyderuiter/TagTools</a> (for latest
beta source code), <a href="https://stacyderuiter.github.io/TagTools/articles/TagTools" class="external-link uri">https://stacyderuiter.github.io/TagTools/articles/TagTools</a>
(vignettes overview)</p>
</div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p></p>
<p>Developed by Stacy DeRuiter, Mark Johnson, David Sweeney, Ye Joo McNamara-Oh, Samuel Fynewever, (Oghenkevwe) Racheal Tejevbo, Tiago Marques, Yuqian Wang, (Oghenesuvwe) Su Ogedegbe.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
